<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/admin-layout.html}">

<head>


    <meta charset="UTF-8">
    <title>Danh s√°ch s·∫£n ph·∫©m</title>

    <!-- Bootstrap + Font Awesome -->
    <link rel="stylesheet" th:href="@{/vendor/fontawesome-free/css/all.min.css}">
    <link rel="stylesheet" th:href="@{/css/sb-admin-2.min.css}">

    <style>
        /* ===== üé® T√πy ch·ªânh nh·∫π ƒë·ªÉ giao di·ªán ƒë·∫πp h∆°n ===== */
        .filter-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .filter-card label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #333;
        }

        .filter-card .form-select,
        .filter-card .form-control {
            border-radius: 6px;
        }

        .btn {
            border-radius: 6px;
        }

        /* B·∫£ng s·∫£n ph·∫©m g·ªçn g√†ng h∆°n */
        table th {
            white-space: nowrap;
        }

        table td {
            vertical-align: middle;
        }

        /* Hi·ªáu ·ª©ng hover tr√™n h√†ng */
        table tbody tr:hover {
            background-color: #f2f7ff;
            transition: 0.2s;
        }
    </style>
</head>

<body>
<div layout:fragment="content">

    <h4 class="mb-4 fw-bold text-primary"><i class="fa fa-boxes"></i> Qu·∫£n l√Ω s·∫£n ph·∫©m</h4>

    <!-- ==========================
         üß© KH·ªêI B·ªò L·ªåC S·∫¢N PH·∫®M
    =========================== -->
    <div class="card mb-4 border-0 shadow-sm filter-card">
        <div class="card-body">
            <!-- Form l·ªçc -->
            <form th:action="@{/admin/product-all}" method="GET" class="row g-3 align-items-end">
                <!-- √î nh·∫≠p m√£ s·∫£n ph·∫©m -->
                <div class="col-md-2">
                    <label><i class="fa fa-barcode"></i> M√£ SP</label>
                    <input type="text" class="form-control form-control-sm"
                           name="maSanPham" placeholder="Nh·∫≠p m√£..."
                           th:value="${maSanPham}">
                </div>

                <!-- √î nh·∫≠p t√™n s·∫£n ph·∫©m -->
                <div class="col-md-2">
                    <label><i class="fa fa-tag"></i> T√™n SP</label>
                    <input type="text" class="form-control form-control-sm"
                           name="tenSanPham" placeholder="Nh·∫≠p t√™n..."
                           th:value="${tenSanPham}">
                </div>

                <!-- Ch·ªçn nh√£n h√†ng -->
                <div class="col-md-2">
                    <label><i class="fa fa-industry"></i> Nh√£n h√†ng</label>
                    <select class="form-select form-select-sm" name="nhanHang" th:value="${nhanHang}">
                        <option th:value="null">T·∫•t c·∫£</option>
                        <option th:each="brand: ${listBrand}"
                                th:value="${brand.id}"
                                th:text="${brand.name}"
                                th:selected="${brand.id == nhanHang}">
                        </option>
                    </select>
                </div>

                <!-- Ch·ªçn ch·∫•t li·ªáu -->
                <div class="col-md-2">
                    <label><i class="fa fa-cube"></i> Ch·∫•t li·ªáu</label>
                    <select class="form-select form-select-sm" name="chatLieu" th:value="${chatLieu}">
                        <option th:value="null">T·∫•t c·∫£</option>
                        <option th:each="material: ${listMaterial}"
                                th:value="${material.id}"
                                th:text="${material.name}"
                                th:selected="${material.id == chatLieu}">
                        </option>
                    </select>
                </div>

                <!-- Ch·ªçn th·ªÉ lo·∫°i -->
                <div class="col-md-2">
                    <label><i class="fa fa-list"></i> Th·ªÉ lo·∫°i</label>
                    <select class="form-select form-select-sm" name="theLoai" th:value="${theLoai}">
                        <option th:value="null">T·∫•t c·∫£</option>
                        <option th:each="category: ${listCategory}"
                                th:value="${category.id}"
                                th:text="${category.name}"
                                th:selected="${category.id == theLoai}">
                        </option>
                    </select>
                </div>

                <!-- Ch·ªçn tr·∫°ng th√°i -->
                <div class="col-md-2">
                    <label><i class="fa fa-toggle-on"></i> Tr·∫°ng th√°i</label>
                    <select class="form-select form-select-sm" name="trangThai" th:value="${trangThai}">
                        <option th:value="null">T·∫•t c·∫£</option>
                        <option value="1" th:selected="${trangThai == 1}">C√≤n b√°n</option>
                        <option value="2" th:selected="${trangThai == 2}">Ng·ª´ng b√°n</option>
                    </select>
                </div>

                <!-- N√∫t thao t√°c -->
                <div class="col-12 text-end mt-3">
                    <button type="submit" class="btn btn-primary btn-sm me-2">
                        <i class="fa fa-search"></i> T√¨m ki·∫øm
                    </button>
                    <a th:href="@{/admin/product-all}" class="btn btn-outline-secondary btn-sm">
                        <i class="fa fa-sync-alt"></i> L√†m m·ªõi
                    </a>
                </div>
            </form>
        </div>
    </div>

    <!-- ==========================
         üì¶ DANH S√ÅCH S·∫¢N PH·∫®M
    =========================== -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-semibold text-dark">Danh s√°ch s·∫£n ph·∫©m</h5>
        <a href="/admin/product-create" class="btn btn-success btn-sm shadow-sm">
            <i class="fa fa-plus-square"></i> Th√™m s·∫£n ph·∫©m
        </a>
    </div>

    <div class="table-responsive shadow-sm rounded">
        <table class="table table-hover align-middle">
            <thead class="table-primary">
            <tr>
                <th>M√£ s·∫£n ph·∫©m</th>
                <th>T√™n s·∫£n ph·∫©m</th>
                <th>Nh√£n h√†ng</th>
                <th>Ch·∫•t li·ªáu</th>
                <th>Th·ªÉ lo·∫°i</th>
<!--                <th>Tr·∫°ng th√°i</th>-->
                <th class="text-center">H√†nh ƒë·ªông</th>
            </tr>
            </thead>
            <tbody>
            <!-- L·∫∑p qua danh s√°ch s·∫£n ph·∫©m -->
            <tr th:each="item : ${items}">
                <td>
                    <a th:href="@{'/admin/chi-tiet-san-pham/' + ${item.maSanPham}}"
                       class="text-decoration-none fw-bold text-primary"
                       th:text="${item.maSanPham}"></a>
                </td>
                <td th:text="${item.tenSanPham}"></td>
                <td th:text="${item.nhanHang}"></td>
                <td th:text="${item.chatLieu}"></td>
                <td th:text="${item.theLoai}"></td>
<!--                <td>-->
<!--                    <span th:switch="${item.trangThai}">-->
<!--                        <span th:case="1" class="badge bg-success">C√≤n b√°n</span>-->
<!--                        <span th:case="2" class="badge bg-secondary">Ng·ª´ng b√°n</span>-->
<!--                        <span th:case="0" class="badge bg-warning text-dark">ƒêang kh·ªüi t·∫°o</span>-->
<!--                    </span>-->
<!--                </td>-->


                <!--                X√≥a s·∫£n ph·∫©m-->
                <td class="text-center">
                    <a th:href="@{'/admin/product-edit/' + ${item.maSanPham}}"
                       class="btn btn-outline-primary btn-sm me-1">
                        <i class="fa fa-edit"></i> S·ª≠a
                    </a>
<!--                    <button type="button"-->
<!--                            class="btn btn-outline-danger btn-sm btn-delete"-->
<!--                            th:data-id="${item.idSanPham}">-->
<!--                        <i class="fa fa-trash"></i>-->
<!--                    </button>-->
<!--                    <span th:switch="${item.trangThai}">-->
        <!-- N·∫øu ƒëang b√°n (1) -->
<!--        <button th:case="1"-->
<!--                type="button"-->
<!--                class="btn btn-outline-warning btn-sm btn-toggle-status"-->
<!--                th:data-id="${item.idSanPham}"-->
<!--                th:data-status="1">-->
<!--            <i class="fa fa-pause-circle"></i> Ng·ª´ng b√°n-->
<!--        </button>-->

<!--                        &lt;!&ndash; N·∫øu ng·ª´ng b√°n (2) &ndash;&gt;-->
<!--        <button th:case="2"-->
<!--                type="button"-->
<!--                class="btn btn-outline-success btn-sm btn-toggle-status"-->
<!--                th:data-id="${item.idSanPham}"-->
<!--                th:data-status="2">-->
<!--            <i class="fa fa-play-circle"></i> B√°n l·∫°i-->
<!--        </button>-->
<!--    </span>-->
                </td>


            </tr>
            </tbody>
        </table>
    </div>

    <!-- ==========================
         üìÑ PH√ÇN TRANG
    =========================== -->
    <div class="d-flex justify-content-end mt-3">
        <ul class="pagination pagination-sm">
            <li th:classappend="${!items.hasPrevious()} ? 'disabled'" class="page-item">
                <a th:href="@{/admin/product-all(page=0)}" class="page-link"><i
                        class="fas fa-angle-double-left"></i></a>
            </li>
            <li th:classappend="${!items.hasPrevious()} ? 'disabled'" class="page-item">
                <a th:href="@{/admin/product-all(page=${items.number - 1})}" class="page-link"><i
                        class="fas fa-angle-left"></i></a>
            </li>
            <li th:classappend="${!items.hasNext()} ? 'disabled'" class="page-item">
                <a th:href="@{/admin/product-all(page=${items.number + 1})}" class="page-link"><i
                        class="fas fa-angle-right"></i></a>
            </li>
            <li th:classappend="${!items.hasNext()} ? 'disabled'" class="page-item">
                <a th:href="@{/admin/product-all(page=${items.totalPages - 1})}" class="page-link"><i
                        class="fas fa-angle-double-right"></i></a>
            </li>
        </ul>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script th:inline="javascript">
        document.querySelectorAll('.btn-delete').forEach(button => {
            button.addEventListener('click', function () {
                const id = this.dataset.id; // L·∫•y ID s·∫£n ph·∫©m

                Swal.fire({
                    title: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn?',
                    text: "S·∫£n ph·∫©m s·∫Ω b·ªã x√≥a !",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33', // M√†u ƒë·ªè cho n√∫t x√°c nh·∫≠n
                    cancelButtonColor: '#6c757d', // M√†u x√°m cho n√∫t h·ªßy
                    confirmButtonText: 'C√≥, x√≥a ngay!',
                    cancelButtonText: 'H·ªßy'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Chuy·ªÉn h∆∞·ªõng t·ªõi URL x√≥a s·∫£n ph·∫©m (d√πng GET theo Controller c·ªßa b·∫°n)
                        window.location.href = '/admin/product-delete/' + id;
                    }
                });
            });
        });
    </script>
</div>
</body>
</html>
